when:
  path: /chat/completions
  method: POST
  json_body_str: >-
    {
      "model": "llama3:latest",
      "messages": [
        {
          "role": "user",
          "content": "Test message"
        }
      ],
      "stream": true,
      "tool_choice": "auto"
    }
then:
  status: 200
  header:
    - name: content-type
      value: text/event-stream
  body: |+
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"role":"assistant","content":null}}],"created":1766136306,"id":"chatcmpl-6gusWJ9FMJPILn3yxzU7Ju0F1eEHnR31","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":"Hello"}}],"created":1766136306,"id":"chatcmpl-6gusWJ9FMJPILn3yxzU7Ju0F1eEHnR31","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":"!"}}],"created":1766136306,"id":"chatcmpl-6gusWJ9FMJPILn3yxzU7Ju0F1eEHnR31","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" How"}}],"created":1766136306,"id":"chatcmpl-6gusWJ9FMJPILn3yxzU7Ju0F1eEHnR31","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" can"}}],"created":1766136306,"id":"chatcmpl-6gusWJ9FMJPILn3yxzU7Ju0F1eEHnR31","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" I"}}],"created":1766136306,"id":"chatcmpl-6gusWJ9FMJPILn3yxzU7Ju0F1eEHnR31","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" assist"}}],"created":1766136306,"id":"chatcmpl-6gusWJ9FMJPILn3yxzU7Ju0F1eEHnR31","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" you"}}],"created":1766136306,"id":"chatcmpl-6gusWJ9FMJPILn3yxzU7Ju0F1eEHnR31","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" today"}}],"created":1766136306,"id":"chatcmpl-6gusWJ9FMJPILn3yxzU7Ju0F1eEHnR31","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":"?"}}],"created":1766136306,"id":"chatcmpl-6gusWJ9FMJPILn3yxzU7Ju0F1eEHnR31","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":"stop","index":0,"delta":{}}],"created":1766136306,"id":"chatcmpl-6gusWJ9FMJPILn3yxzU7Ju0F1eEHnR31","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk","usage":{"completion_tokens":10,"prompt_tokens":31,"total_tokens":41},"timings":{"prompt_n":31,"prompt_ms":122.787,"prompt_per_token_ms":3.960870967741936,"prompt_per_second":252.4697239935824,"predicted_n":10,"predicted_ms":172.58,"predicted_per_token_ms":17.258000000000003,"predicted_per_second":57.94414184725924}}
    
    data: [DONE]
    
