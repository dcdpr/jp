when:
  path: /chat/completions
  method: POST
  json_body_str: >-
    {
      "model": "llama3:latest",
      "messages": [
        {
          "role": "user",
          "content": "Test message"
        }
      ],
      "stream": true,
      "tool_choice": "auto"
    }
then:
  status: 200
  header:
    - name: content-type
      value: text/event-stream
  body: |-
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"role":"assistant","content":null}}],"created":1765284604,"id":"chatcmpl-e7wsgITlKaH0RqGBaHD2ptSucJnkZYHo","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}

    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":"Hello"}}],"created":1765284604,"id":"chatcmpl-e7wsgITlKaH0RqGBaHD2ptSucJnkZYHo","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}

    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":"!"}}],"created":1765284604,"id":"chatcmpl-e7wsgITlKaH0RqGBaHD2ptSucJnkZYHo","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}

    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" How"}}],"created":1765284604,"id":"chatcmpl-e7wsgITlKaH0RqGBaHD2ptSucJnkZYHo","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}

    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" can"}}],"created":1765284604,"id":"chatcmpl-e7wsgITlKaH0RqGBaHD2ptSucJnkZYHo","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}

    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" I"}}],"created":1765284605,"id":"chatcmpl-e7wsgITlKaH0RqGBaHD2ptSucJnkZYHo","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}

    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" assist"}}],"created":1765284605,"id":"chatcmpl-e7wsgITlKaH0RqGBaHD2ptSucJnkZYHo","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}

    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" you"}}],"created":1765284605,"id":"chatcmpl-e7wsgITlKaH0RqGBaHD2ptSucJnkZYHo","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}

    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" today"}}],"created":1765284605,"id":"chatcmpl-e7wsgITlKaH0RqGBaHD2ptSucJnkZYHo","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}

    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":"?"}}],"created":1765284605,"id":"chatcmpl-e7wsgITlKaH0RqGBaHD2ptSucJnkZYHo","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}

    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" Do"}}],"created":1765284605,"id":"chatcmpl-e7wsgITlKaH0RqGBaHD2ptSucJnkZYHo","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}

    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" you"}}],"created":1765284605,"id":"chatcmpl-e7wsgITlKaH0RqGBaHD2ptSucJnkZYHo","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}

    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" have"}}],"created":1765284605,"id":"chatcmpl-e7wsgITlKaH0RqGBaHD2ptSucJnkZYHo","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}

    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" any"}}],"created":1765284605,"id":"chatcmpl-e7wsgITlKaH0RqGBaHD2ptSucJnkZYHo","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}

    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" specific"}}],"created":1765284605,"id":"chatcmpl-e7wsgITlKaH0RqGBaHD2ptSucJnkZYHo","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}

    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" questions"}}],"created":1765284605,"id":"chatcmpl-e7wsgITlKaH0RqGBaHD2ptSucJnkZYHo","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}

    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" or"}}],"created":1765284605,"id":"chatcmpl-e7wsgITlKaH0RqGBaHD2ptSucJnkZYHo","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}

    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" topics"}}],"created":1765284605,"id":"chatcmpl-e7wsgITlKaH0RqGBaHD2ptSucJnkZYHo","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}

    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" you"}}],"created":1765284605,"id":"chatcmpl-e7wsgITlKaH0RqGBaHD2ptSucJnkZYHo","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}

    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":"'d"}}],"created":1765284605,"id":"chatcmpl-e7wsgITlKaH0RqGBaHD2ptSucJnkZYHo","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}

    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" like"}}],"created":1765284605,"id":"chatcmpl-e7wsgITlKaH0RqGBaHD2ptSucJnkZYHo","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}

    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" to"}}],"created":1765284605,"id":"chatcmpl-e7wsgITlKaH0RqGBaHD2ptSucJnkZYHo","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}

    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" discuss"}}],"created":1765284605,"id":"chatcmpl-e7wsgITlKaH0RqGBaHD2ptSucJnkZYHo","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}

    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":"?"}}],"created":1765284605,"id":"chatcmpl-e7wsgITlKaH0RqGBaHD2ptSucJnkZYHo","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}

    data: {"choices":[{"finish_reason":"stop","index":0,"delta":{}}],"created":1765284605,"id":"chatcmpl-e7wsgITlKaH0RqGBaHD2ptSucJnkZYHo","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk","usage":{"completion_tokens":24,"prompt_tokens":31,"total_tokens":55},"timings":{"prompt_n":7,"prompt_ms":100.755,"prompt_per_token_ms":14.393571428571429,"prompt_per_second":69.47546027492433,"predicted_n":24,"predicted_ms":452.072,"predicted_per_token_ms":18.836333333333332,"predicted_per_second":53.08888849563787}}

    data: [DONE]
