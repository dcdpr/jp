when:
  path: /chat/completions
  method: POST
  json_body_str: >-
    {
      "model": "llama3:latest",
      "messages": [
        {
          "role": "user",
          "content": "Test message"
        }
      ],
      "stream": true,
      "tool_choice": "auto"
    }
then:
  status: 200
  header:
    - name: content-type
      value: text/event-stream
  body: |+
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"role":"assistant","content":null}}],"created":1766136307,"id":"chatcmpl-EbnmQ748V4rHXDE3z2lEjtMb1eq1YdFr","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":"Hello"}}],"created":1766136307,"id":"chatcmpl-EbnmQ748V4rHXDE3z2lEjtMb1eq1YdFr","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":"!"}}],"created":1766136307,"id":"chatcmpl-EbnmQ748V4rHXDE3z2lEjtMb1eq1YdFr","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" How"}}],"created":1766136307,"id":"chatcmpl-EbnmQ748V4rHXDE3z2lEjtMb1eq1YdFr","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" can"}}],"created":1766136307,"id":"chatcmpl-EbnmQ748V4rHXDE3z2lEjtMb1eq1YdFr","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" I"}}],"created":1766136307,"id":"chatcmpl-EbnmQ748V4rHXDE3z2lEjtMb1eq1YdFr","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" assist"}}],"created":1766136307,"id":"chatcmpl-EbnmQ748V4rHXDE3z2lEjtMb1eq1YdFr","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" you"}}],"created":1766136307,"id":"chatcmpl-EbnmQ748V4rHXDE3z2lEjtMb1eq1YdFr","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" today"}}],"created":1766136307,"id":"chatcmpl-EbnmQ748V4rHXDE3z2lEjtMb1eq1YdFr","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":"?"}}],"created":1766136307,"id":"chatcmpl-EbnmQ748V4rHXDE3z2lEjtMb1eq1YdFr","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":"stop","index":0,"delta":{}}],"created":1766136307,"id":"chatcmpl-EbnmQ748V4rHXDE3z2lEjtMb1eq1YdFr","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk","usage":{"completion_tokens":10,"prompt_tokens":31,"total_tokens":41},"timings":{"prompt_n":1,"prompt_ms":19.295,"prompt_per_token_ms":19.295,"prompt_per_second":51.82689816014511,"predicted_n":10,"predicted_ms":171.579,"predicted_per_token_ms":17.1579,"predicted_per_second":58.282190710984445}}
    
    data: [DONE]
    
---
when:
  path: /chat/completions
  method: POST
  json_body_str: >-
    {
      "model": "llama3:latest",
      "messages": [
        {
          "role": "user",
          "content": "Test message"
        },
        {
          "role": "assistant",
          "content": "Hello! How can I assist you today?"
        },
        {
          "role": "user",
          "content": "Repeat my previous message"
        }
      ],
      "stream": true,
      "tool_choice": "auto"
    }
then:
  status: 200
  header:
    - name: content-type
      value: text/event-stream
  body: |+
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"role":"assistant","content":null}}],"created":1766136312,"id":"chatcmpl-an6VuGebX3iZGdnMeLi0Kmwopfg2UoSS","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":"Your"}}],"created":1766136312,"id":"chatcmpl-an6VuGebX3iZGdnMeLi0Kmwopfg2UoSS","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" previous"}}],"created":1766136312,"id":"chatcmpl-an6VuGebX3iZGdnMeLi0Kmwopfg2UoSS","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" message"}}],"created":1766136312,"id":"chatcmpl-an6VuGebX3iZGdnMeLi0Kmwopfg2UoSS","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" was"}}],"created":1766136312,"id":"chatcmpl-an6VuGebX3iZGdnMeLi0Kmwopfg2UoSS","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":":"}}],"created":1766136312,"id":"chatcmpl-an6VuGebX3iZGdnMeLi0Kmwopfg2UoSS","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" \""}}],"created":1766136312,"id":"chatcmpl-an6VuGebX3iZGdnMeLi0Kmwopfg2UoSS","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":"Test"}}],"created":1766136312,"id":"chatcmpl-an6VuGebX3iZGdnMeLi0Kmwopfg2UoSS","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" message"}}],"created":1766136312,"id":"chatcmpl-an6VuGebX3iZGdnMeLi0Kmwopfg2UoSS","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":"\""}}],"created":1766136312,"id":"chatcmpl-an6VuGebX3iZGdnMeLi0Kmwopfg2UoSS","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":"stop","index":0,"delta":{}}],"created":1766136312,"id":"chatcmpl-an6VuGebX3iZGdnMeLi0Kmwopfg2UoSS","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk","usage":{"completion_tokens":10,"prompt_tokens":54,"total_tokens":64},"timings":{"prompt_n":36,"prompt_ms":144.593,"prompt_per_token_ms":4.016472222222222,"prompt_per_second":248.97470831921328,"predicted_n":10,"predicted_ms":170.902,"predicted_per_token_ms":17.0902,"predicted_per_second":58.51306596763058}}
    
    data: [DONE]
    
---
when:
  path: /chat/completions
  method: POST
  json_body_str: >-
    {
      "model": "llama3:latest",
      "messages": [
        {
          "role": "user",
          "content": "Test message"
        },
        {
          "role": "assistant",
          "content": "Hello! How can I assist you today?"
        },
        {
          "role": "user",
          "content": "Repeat my previous message"
        },
        {
          "role": "assistant",
          "content": "Your previous message was: \"Test message\""
        },
        {
          "role": "user",
          "content": "Please run the tool, providing whatever arguments you want."
        }
      ],
      "stream": true,
      "tools": [
        {
          "type": "function",
          "function": {
            "name": "run_me",
            "description": "",
            "parameters": {
              "type": "object",
              "properties": {
                "foo": {
                  "type": "string",
                  "default": "foo"
                },
                "bar": {
                  "type": [
                    "string",
                    "array"
                  ],
                  "enum": [
                    "foo"
                  ],
                  "items": {
                    "type": "string",
                    "enum": [
                      "foo",
                      "bar"
                    ]
                  }
                }
              },
              "additionalProperties": true,
              "required": [
                "bar"
              ]
            },
            "strict": false
          }
        }
      ],
      "tool_choice": "required"
    }
then:
  status: 200
  header:
    - name: content-type
      value: text/event-stream
  body: |+
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"role":"assistant","content":null}}],"created":1766136321,"id":"chatcmpl-i3dpbzVcrHOOINhFLf6xXVC3BJIk2K3n","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"tool_calls":[{"index":0,"id":"WjDshW4vtjLxBHBjsxylldF4DKnQUNOs","type":"function","function":{"name":"run_me","arguments":""}}]}}],"created":1766136321,"id":"chatcmpl-i3dpbzVcrHOOINhFLf6xXVC3BJIk2K3n","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"tool_calls":[{"index":0,"function":{"arguments":"{\""}}]}}],"created":1766136321,"id":"chatcmpl-i3dpbzVcrHOOINhFLf6xXVC3BJIk2K3n","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"tool_calls":[{"index":0,"function":{"arguments":"bar"}}]}}],"created":1766136321,"id":"chatcmpl-i3dpbzVcrHOOINhFLf6xXVC3BJIk2K3n","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"tool_calls":[{"index":0,"function":{"arguments":"\":"}}]}}],"created":1766136321,"id":"chatcmpl-i3dpbzVcrHOOINhFLf6xXVC3BJIk2K3n","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"tool_calls":[{"index":0,"function":{"arguments":"\""}}]}}],"created":1766136322,"id":"chatcmpl-i3dpbzVcrHOOINhFLf6xXVC3BJIk2K3n","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"tool_calls":[{"index":0,"function":{"arguments":"foo"}}]}}],"created":1766136322,"id":"chatcmpl-i3dpbzVcrHOOINhFLf6xXVC3BJIk2K3n","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"tool_calls":[{"index":0,"function":{"arguments":"\","}}]}}],"created":1766136322,"id":"chatcmpl-i3dpbzVcrHOOINhFLf6xXVC3BJIk2K3n","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"tool_calls":[{"index":0,"function":{"arguments":"\""}}]}}],"created":1766136322,"id":"chatcmpl-i3dpbzVcrHOOINhFLf6xXVC3BJIk2K3n","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"tool_calls":[{"index":0,"function":{"arguments":"foo"}}]}}],"created":1766136322,"id":"chatcmpl-i3dpbzVcrHOOINhFLf6xXVC3BJIk2K3n","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"tool_calls":[{"index":0,"function":{"arguments":"\":"}}]}}],"created":1766136322,"id":"chatcmpl-i3dpbzVcrHOOINhFLf6xXVC3BJIk2K3n","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"tool_calls":[{"index":0,"function":{"arguments":"\""}}]}}],"created":1766136322,"id":"chatcmpl-i3dpbzVcrHOOINhFLf6xXVC3BJIk2K3n","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"tool_calls":[{"index":0,"function":{"arguments":"test"}}]}}],"created":1766136322,"id":"chatcmpl-i3dpbzVcrHOOINhFLf6xXVC3BJIk2K3n","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"tool_calls":[{"index":0,"function":{"arguments":"\"}"}}]}}],"created":1766136322,"id":"chatcmpl-i3dpbzVcrHOOINhFLf6xXVC3BJIk2K3n","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":"tool_calls","index":0,"delta":{}}],"created":1766136322,"id":"chatcmpl-i3dpbzVcrHOOINhFLf6xXVC3BJIk2K3n","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk","usage":{"completion_tokens":26,"prompt_tokens":260,"total_tokens":286},"timings":{"prompt_n":242,"prompt_ms":605.582,"prompt_per_token_ms":2.502404958677686,"prompt_per_second":399.6155764206994,"predicted_n":26,"predicted_ms":822.679,"predicted_per_token_ms":31.6415,"predicted_per_second":31.604064282666755}}
    
    data: [DONE]
    
---
when:
  path: /chat/completions
  method: POST
  json_body_str: >-
    {
      "model": "llama3:latest",
      "messages": [
        {
          "role": "user",
          "content": "Test message"
        },
        {
          "role": "assistant",
          "content": "Hello! How can I assist you today?"
        },
        {
          "role": "user",
          "content": "Repeat my previous message"
        },
        {
          "role": "assistant",
          "content": "Your previous message was: \"Test message\""
        },
        {
          "role": "user",
          "content": "Please run the tool, providing whatever arguments you want."
        },
        {
          "role": "assistant",
          "content": null,
          "tool_calls": [
            {
              "id": "WjDshW4vtjLxBHBjsxylldF4DKnQUNOs",
              "type": "function",
              "function": {
                "name": "run_me",
                "arguments": "{\"bar\":\"foo\",\"foo\":\"test\"}"
              }
            }
          ]
        },
        {
          "role": "tool",
          "content": "The secret code is: 42",
          "tool_call_id": "WjDshW4vtjLxBHBjsxylldF4DKnQUNOs"
        }
      ],
      "stream": true,
      "tool_choice": "auto"
    }
then:
  status: 200
  header:
    - name: content-type
      value: text/event-stream
  body: |+
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"role":"assistant","content":null}}],"created":1766136330,"id":"chatcmpl-tOLXxUdVL4cv63YdmBgeKXW03jo9Uvn0","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":"The"}}],"created":1766136330,"id":"chatcmpl-tOLXxUdVL4cv63YdmBgeKXW03jo9Uvn0","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" tool"}}],"created":1766136330,"id":"chatcmpl-tOLXxUdVL4cv63YdmBgeKXW03jo9Uvn0","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" response"}}],"created":1766136330,"id":"chatcmpl-tOLXxUdVL4cv63YdmBgeKXW03jo9Uvn0","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" indicates"}}],"created":1766136330,"id":"chatcmpl-tOLXxUdVL4cv63YdmBgeKXW03jo9Uvn0","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" that"}}],"created":1766136330,"id":"chatcmpl-tOLXxUdVL4cv63YdmBgeKXW03jo9Uvn0","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" the"}}],"created":1766136330,"id":"chatcmpl-tOLXxUdVL4cv63YdmBgeKXW03jo9Uvn0","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" secret"}}],"created":1766136330,"id":"chatcmpl-tOLXxUdVL4cv63YdmBgeKXW03jo9Uvn0","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" code"}}],"created":1766136330,"id":"chatcmpl-tOLXxUdVL4cv63YdmBgeKXW03jo9Uvn0","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" is"}}],"created":1766136330,"id":"chatcmpl-tOLXxUdVL4cv63YdmBgeKXW03jo9Uvn0","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":":"}}],"created":1766136330,"id":"chatcmpl-tOLXxUdVL4cv63YdmBgeKXW03jo9Uvn0","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" "}}],"created":1766136331,"id":"chatcmpl-tOLXxUdVL4cv63YdmBgeKXW03jo9Uvn0","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":"4"}}],"created":1766136331,"id":"chatcmpl-tOLXxUdVL4cv63YdmBgeKXW03jo9Uvn0","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":"2"}}],"created":1766136331,"id":"chatcmpl-tOLXxUdVL4cv63YdmBgeKXW03jo9Uvn0","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":"."}}],"created":1766136331,"id":"chatcmpl-tOLXxUdVL4cv63YdmBgeKXW03jo9Uvn0","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" Is"}}],"created":1766136331,"id":"chatcmpl-tOLXxUdVL4cv63YdmBgeKXW03jo9Uvn0","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" there"}}],"created":1766136331,"id":"chatcmpl-tOLXxUdVL4cv63YdmBgeKXW03jo9Uvn0","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" anything"}}],"created":1766136331,"id":"chatcmpl-tOLXxUdVL4cv63YdmBgeKXW03jo9Uvn0","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" you"}}],"created":1766136331,"id":"chatcmpl-tOLXxUdVL4cv63YdmBgeKXW03jo9Uvn0","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" want"}}],"created":1766136331,"id":"chatcmpl-tOLXxUdVL4cv63YdmBgeKXW03jo9Uvn0","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" to"}}],"created":1766136331,"id":"chatcmpl-tOLXxUdVL4cv63YdmBgeKXW03jo9Uvn0","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" do"}}],"created":1766136331,"id":"chatcmpl-tOLXxUdVL4cv63YdmBgeKXW03jo9Uvn0","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" with"}}],"created":1766136331,"id":"chatcmpl-tOLXxUdVL4cv63YdmBgeKXW03jo9Uvn0","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" this"}}],"created":1766136331,"id":"chatcmpl-tOLXxUdVL4cv63YdmBgeKXW03jo9Uvn0","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" code"}}],"created":1766136331,"id":"chatcmpl-tOLXxUdVL4cv63YdmBgeKXW03jo9Uvn0","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" or"}}],"created":1766136331,"id":"chatcmpl-tOLXxUdVL4cv63YdmBgeKXW03jo9Uvn0","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" any"}}],"created":1766136331,"id":"chatcmpl-tOLXxUdVL4cv63YdmBgeKXW03jo9Uvn0","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" further"}}],"created":1766136331,"id":"chatcmpl-tOLXxUdVL4cv63YdmBgeKXW03jo9Uvn0","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" assistance"}}],"created":1766136331,"id":"chatcmpl-tOLXxUdVL4cv63YdmBgeKXW03jo9Uvn0","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" you"}}],"created":1766136331,"id":"chatcmpl-tOLXxUdVL4cv63YdmBgeKXW03jo9Uvn0","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" need"}}],"created":1766136331,"id":"chatcmpl-tOLXxUdVL4cv63YdmBgeKXW03jo9Uvn0","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":"?"}}],"created":1766136331,"id":"chatcmpl-tOLXxUdVL4cv63YdmBgeKXW03jo9Uvn0","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":"stop","index":0,"delta":{}}],"created":1766136331,"id":"chatcmpl-tOLXxUdVL4cv63YdmBgeKXW03jo9Uvn0","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk","usage":{"completion_tokens":32,"prompt_tokens":136,"total_tokens":168},"timings":{"prompt_n":112,"prompt_ms":334.82,"prompt_per_token_ms":2.9894642857142855,"prompt_per_second":334.50809390120065,"predicted_n":32,"predicted_ms":1003.13,"predicted_per_token_ms":31.3478125,"predicted_per_second":31.900152522604248}}
    
    data: [DONE]
    
---
when:
  path: /chat/completions
  method: POST
  json_body_str: >-
    {
      "model": "llama3:latest",
      "messages": [
        {
          "role": "user",
          "content": "Test message"
        },
        {
          "role": "assistant",
          "content": "Hello! How can I assist you today?"
        },
        {
          "role": "user",
          "content": "Repeat my previous message"
        },
        {
          "role": "assistant",
          "content": "Your previous message was: \"Test message\""
        },
        {
          "role": "user",
          "content": "Please run the tool, providing whatever arguments you want."
        },
        {
          "role": "assistant",
          "content": null,
          "tool_calls": [
            {
              "id": "WjDshW4vtjLxBHBjsxylldF4DKnQUNOs",
              "type": "function",
              "function": {
                "name": "run_me",
                "arguments": "{\"bar\":\"foo\",\"foo\":\"test\"}"
              }
            }
          ]
        },
        {
          "role": "tool",
          "content": "The secret code is: 42",
          "tool_call_id": "WjDshW4vtjLxBHBjsxylldF4DKnQUNOs"
        },
        {
          "role": "assistant",
          "content": "The tool response indicates that the secret code is: 42. Is there anything you want to do with this code or any further assistance you need?"
        },
        {
          "role": "user",
          "content": "What was the result of the previous tool call?"
        }
      ],
      "stream": true,
      "tool_choice": "auto"
    }
then:
  status: 200
  header:
    - name: content-type
      value: text/event-stream
  body: |+
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"role":"assistant","content":null}}],"created":1766136331,"id":"chatcmpl-9dGCfvTzF10PoCCObZaiu9rqX4moAB1b","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":"The"}}],"created":1766136331,"id":"chatcmpl-9dGCfvTzF10PoCCObZaiu9rqX4moAB1b","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" result"}}],"created":1766136331,"id":"chatcmpl-9dGCfvTzF10PoCCObZaiu9rqX4moAB1b","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" of"}}],"created":1766136331,"id":"chatcmpl-9dGCfvTzF10PoCCObZaiu9rqX4moAB1b","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" the"}}],"created":1766136331,"id":"chatcmpl-9dGCfvTzF10PoCCObZaiu9rqX4moAB1b","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" previous"}}],"created":1766136331,"id":"chatcmpl-9dGCfvTzF10PoCCObZaiu9rqX4moAB1b","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" tool"}}],"created":1766136331,"id":"chatcmpl-9dGCfvTzF10PoCCObZaiu9rqX4moAB1b","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" call"}}],"created":1766136331,"id":"chatcmpl-9dGCfvTzF10PoCCObZaiu9rqX4moAB1b","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" was"}}],"created":1766136332,"id":"chatcmpl-9dGCfvTzF10PoCCObZaiu9rqX4moAB1b","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":":"}}],"created":1766136332,"id":"chatcmpl-9dGCfvTzF10PoCCObZaiu9rqX4moAB1b","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" \""}}],"created":1766136332,"id":"chatcmpl-9dGCfvTzF10PoCCObZaiu9rqX4moAB1b","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":"The"}}],"created":1766136332,"id":"chatcmpl-9dGCfvTzF10PoCCObZaiu9rqX4moAB1b","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" secret"}}],"created":1766136332,"id":"chatcmpl-9dGCfvTzF10PoCCObZaiu9rqX4moAB1b","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" code"}}],"created":1766136332,"id":"chatcmpl-9dGCfvTzF10PoCCObZaiu9rqX4moAB1b","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" is"}}],"created":1766136332,"id":"chatcmpl-9dGCfvTzF10PoCCObZaiu9rqX4moAB1b","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":":"}}],"created":1766136332,"id":"chatcmpl-9dGCfvTzF10PoCCObZaiu9rqX4moAB1b","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" "}}],"created":1766136332,"id":"chatcmpl-9dGCfvTzF10PoCCObZaiu9rqX4moAB1b","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":"4"}}],"created":1766136332,"id":"chatcmpl-9dGCfvTzF10PoCCObZaiu9rqX4moAB1b","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":"2"}}],"created":1766136332,"id":"chatcmpl-9dGCfvTzF10PoCCObZaiu9rqX4moAB1b","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":"\"."}}],"created":1766136332,"id":"chatcmpl-9dGCfvTzF10PoCCObZaiu9rqX4moAB1b","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" \n\n"}}],"created":1766136332,"id":"chatcmpl-9dGCfvTzF10PoCCObZaiu9rqX4moAB1b","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":"Is"}}],"created":1766136332,"id":"chatcmpl-9dGCfvTzF10PoCCObZaiu9rqX4moAB1b","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" there"}}],"created":1766136332,"id":"chatcmpl-9dGCfvTzF10PoCCObZaiu9rqX4moAB1b","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" anything"}}],"created":1766136332,"id":"chatcmpl-9dGCfvTzF10PoCCObZaiu9rqX4moAB1b","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" specific"}}],"created":1766136332,"id":"chatcmpl-9dGCfvTzF10PoCCObZaiu9rqX4moAB1b","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" you"}}],"created":1766136332,"id":"chatcmpl-9dGCfvTzF10PoCCObZaiu9rqX4moAB1b","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" would"}}],"created":1766136332,"id":"chatcmpl-9dGCfvTzF10PoCCObZaiu9rqX4moAB1b","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" like"}}],"created":1766136332,"id":"chatcmpl-9dGCfvTzF10PoCCObZaiu9rqX4moAB1b","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" to"}}],"created":1766136332,"id":"chatcmpl-9dGCfvTzF10PoCCObZaiu9rqX4moAB1b","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" do"}}],"created":1766136332,"id":"chatcmpl-9dGCfvTzF10PoCCObZaiu9rqX4moAB1b","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" with"}}],"created":1766136332,"id":"chatcmpl-9dGCfvTzF10PoCCObZaiu9rqX4moAB1b","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" this"}}],"created":1766136332,"id":"chatcmpl-9dGCfvTzF10PoCCObZaiu9rqX4moAB1b","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" information"}}],"created":1766136332,"id":"chatcmpl-9dGCfvTzF10PoCCObZaiu9rqX4moAB1b","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" or"}}],"created":1766136332,"id":"chatcmpl-9dGCfvTzF10PoCCObZaiu9rqX4moAB1b","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" any"}}],"created":1766136332,"id":"chatcmpl-9dGCfvTzF10PoCCObZaiu9rqX4moAB1b","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" further"}}],"created":1766136332,"id":"chatcmpl-9dGCfvTzF10PoCCObZaiu9rqX4moAB1b","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" assistance"}}],"created":1766136332,"id":"chatcmpl-9dGCfvTzF10PoCCObZaiu9rqX4moAB1b","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":" needed"}}],"created":1766136332,"id":"chatcmpl-9dGCfvTzF10PoCCObZaiu9rqX4moAB1b","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":null,"index":0,"delta":{"content":"?"}}],"created":1766136332,"id":"chatcmpl-9dGCfvTzF10PoCCObZaiu9rqX4moAB1b","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk"}
    
    data: {"choices":[{"finish_reason":"stop","index":0,"delta":{}}],"created":1766136332,"id":"chatcmpl-9dGCfvTzF10PoCCObZaiu9rqX4moAB1b","model":"llama3:latest","system_fingerprint":"b5740-fa4a9f2a","object":"chat.completion.chunk","usage":{"completion_tokens":39,"prompt_tokens":187,"total_tokens":226},"timings":{"prompt_n":20,"prompt_ms":129.982,"prompt_per_token_ms":6.4991,"prompt_per_second":153.86745857118677,"predicted_n":39,"predicted_ms":1190.254,"predicted_per_token_ms":30.519333333333332,"predicted_per_second":32.76611546779091}}
    
    data: [DONE]
    
