when:
  path: "/v1beta/models/gemini-2.5-flash-lite:streamGenerateContent"
  method: POST
  query_param:
    - name: alt
      value: sse
  json_body_str: >-
    {
      "contents": [
        {
          "parts": [
            {
              "text": "I am testing the structured completion API."
            }
          ],
          "role": "user"
        }
      ],
      "tools": [
        {
          "functionDeclarations": [
            {
              "name": "generate_structured_data",
              "description": "This tool can be used to deliver structured data to the caller. It is NOT intended to GENERATE the requested data, but instead as a structured delivery mechanism. The tool is a no-op implementation in that it allows the assistant to deliver structured data to the user, but the tool will never report back with a result, instead the user can take the structured data from the tool arguments provided. Here is the description for the requested structured data:\\n\\n1 + 1 = ?",
              "parameters": null,
              "parametersJsonSchema": {
                "type": "object",
                "properties": {
                  "answer": {
                    "type": "integer"
                  }
                },
                "additionalProperties": false,
                "required": [
                  "answer"
                ]
              },
              "response": null
            }
          ]
        }
      ],
      "toolConfig": {
        "functionCallingConfig": {
          "mode": "ANY",
          "allowedFunctionNames": [
            "generate_structured_data"
          ]
        }
      },
      "generationConfig": {
        "maxOutputTokens": 64000,
        "thinkingConfig": {
          "includeThoughts": false,
          "thinkingBudget": null,
          "thinkingLevel": null
        }
      }
    }
then:
  status: 200
  header:
    - name: content-type
      value: text/event-stream
  body: "data: {\"candidates\": [{\"content\": {\"parts\": [{\"functionCall\": {\"name\": \"generate_structured_data\",\"args\": {\"answer\": 2}}}],\"role\": \"model\"},\"finishReason\": \"STOP\",\"index\": 0,\"finishMessage\": \"Model generated function call(s).\"}],\"usageMetadata\": {\"promptTokenCount\": 140,\"candidatesTokenCount\": 17,\"totalTokenCount\": 157,\"promptTokensDetails\": [{\"modality\": \"TEXT\",\"tokenCount\": 140}]},\"modelVersion\": \"gemini-2.5-flash-lite\",\"responseId\": \"7Bo4ab2TJMm1nsEPjvDmqQs\"}"
---
when:
  path: "/v1beta/models/gemini-2.5-flash-lite:streamGenerateContent"
  method: POST
  query_param:
    - name: alt
      value: sse
    - name: key
      value: AIzaSyC74N0NUrekEdDC7FSeijNDYGXYpZbuSuE
  json_body_str: >-
    {
      "systemInstruction": {
        "parts": [
          {
            "text": "<instruction>\\n  <title>Structured Data Validation Error</title>\\n  <description>The following error occurred while validating the structured data. Please try again.</description>\\n  <Items>\\n    <item>You thought 1 + 1 = 2? Think again!</item>\\n  </Items>\\n  <examples/>\\n</instruction>"
          }
        ],
        "role": null
      },
      "contents": [
        {
          "parts": [
            {
              "text": "I am testing the structured completion API."
            }
          ],
          "role": "user"
        }
      ],
      "tools": [
        {
          "functionDeclarations": [
            {
              "name": "generate_structured_data",
              "description": "This tool can be used to deliver structured data to the caller. It is NOT intended to GENERATE the requested data, but instead as a structured delivery mechanism. The tool is a no-op implementation in that it allows the assistant to deliver structured data to the user, but the tool will never report back with a result, instead the user can take the structured data from the tool arguments provided. Here is the description for the requested structured data:\\n\\n1 + 1 = ?",
              "parameters": null,
              "parametersJsonSchema": {
                "type": "object",
                "properties": {
                  "answer": {
                    "type": "integer"
                  }
                },
                "additionalProperties": false,
                "required": [
                  "answer"
                ]
              },
              "response": null
            }
          ]
        }
      ],
      "toolConfig": {
        "functionCallingConfig": {
          "mode": "ANY",
          "allowedFunctionNames": [
            "generate_structured_data"
          ]
        }
      },
      "generationConfig": {
        "maxOutputTokens": 64000,
        "thinkingConfig": {
          "includeThoughts": false,
          "thinkingBudget": null,
          "thinkingLevel": null
        }
      }
    }
then:
  status: 200
  header:
    - name: content-type
      value: text/event-stream
  body: "data: {\"candidates\": [{\"content\": {\"parts\": [{\"functionCall\": {\"name\": \"generate_structured_data\",\"args\": {\"answer\": 2}}}],\"role\": \"model\"},\"finishReason\": \"STOP\",\"index\": 0,\"finishMessage\": \"Model generated function call(s).\"}],\"usageMetadata\": {\"promptTokenCount\": 216,\"candidatesTokenCount\": 17,\"totalTokenCount\": 233,\"promptTokensDetails\": [{\"modality\": \"TEXT\",\"tokenCount\": 216}]},\"modelVersion\": \"gemini-2.5-flash-lite\",\"responseId\": \"7Bo4ab6QPNjcnsEPgqK-wQs\"}"
---
when:
  path: "/v1beta/models/gemini-2.5-flash-lite:streamGenerateContent"
  method: POST
  query_param:
    - name: alt
      value: sse
    - name: key
      value: AIzaSyC74N0NUrekEdDC7FSeijNDYGXYpZbuSuE
  json_body_str: >-
    {
      "systemInstruction": {
        "parts": [
          {
            "text": "<instruction>\\n  <title>Structured Data Validation Error</title>\\n  <description>The following error occurred while validating the structured data. Please try again.</description>\\n  <Items>\\n    <item>You thought 1 + 1 = 2? Think again!</item>\\n  </Items>\\n  <examples/>\\n</instruction>\\n\\n<instruction>\\n  <title>Structured Data Validation Error</title>\\n  <description>The following error occurred while validating the structured data. Please try again.</description>\\n  <Items>\\n    <item>You thought 1 + 1 = 2? Think again!</item>\\n  </Items>\\n  <examples/>\\n</instruction>"
          }
        ],
        "role": null
      },
      "contents": [
        {
          "parts": [
            {
              "text": "I am testing the structured completion API."
            }
          ],
          "role": "user"
        }
      ],
      "tools": [
        {
          "functionDeclarations": [
            {
              "name": "generate_structured_data",
              "description": "This tool can be used to deliver structured data to the caller. It is NOT intended to GENERATE the requested data, but instead as a structured delivery mechanism. The tool is a no-op implementation in that it allows the assistant to deliver structured data to the user, but the tool will never report back with a result, instead the user can take the structured data from the tool arguments provided. Here is the description for the requested structured data:\\n\\n1 + 1 = ?",
              "parameters": null,
              "parametersJsonSchema": {
                "type": "object",
                "properties": {
                  "answer": {
                    "type": "integer"
                  }
                },
                "additionalProperties": false,
                "required": [
                  "answer"
                ]
              },
              "response": null
            }
          ]
        }
      ],
      "toolConfig": {
        "functionCallingConfig": {
          "mode": "ANY",
          "allowedFunctionNames": [
            "generate_structured_data"
          ]
        }
      },
      "generationConfig": {
        "maxOutputTokens": 64000,
        "thinkingConfig": {
          "includeThoughts": false,
          "thinkingBudget": null,
          "thinkingLevel": null
        }
      }
    }
then:
  status: 200
  header:
    - name: content-type
      value: text/event-stream
  body: "data: {\"candidates\": [{\"content\": {\"parts\": [{\"functionCall\": {\"name\": \"generate_structured_data\",\"args\": {\"answer\": 2}}}],\"role\": \"model\"},\"finishReason\": \"STOP\",\"index\": 0,\"finishMessage\": \"Model generated function call(s).\"}],\"usageMetadata\": {\"promptTokenCount\": 293,\"candidatesTokenCount\": 17,\"totalTokenCount\": 310,\"promptTokensDetails\": [{\"modality\": \"TEXT\",\"tokenCount\": 293}]},\"modelVersion\": \"gemini-2.5-flash-lite\",\"responseId\": \"7Ro4adD1Heft7M8P9IPg0Q8\"}"
